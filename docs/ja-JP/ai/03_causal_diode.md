
# **03_causal_diode.md — 因果ダイオード（Causal Diode）**

## 🧭 はじめに

因果ダイオード（Causal Diode）は、  
NRA‑IDE の中核を成す **最重要構造**です。

その役割はただ一つ：

> **Cause → Effect の一方向性を保証し、  
> Effect → Cause の逆導出（Π⁻¹）を構造的に禁止すること。**

この構造が破られた瞬間、  
NRA‑IDE は **Fail‑Closed（沈黙）** します。

---

# 🎯 1. 因果ダイオードとは何か

因果ダイオードは、  
**因果（Cause）と射影（Effect）を完全に分離するための構造的装置**です。

```
Cause（因果） → Effect（射影）   ✔ 許可
Effect（射影） → Cause（因果）   ❌ 禁止（Π⁻¹）
```

この一方向性は、  
電子回路におけるダイオードのように **逆流を完全に遮断**します。

---

# 🎯 2. なぜ逆導出（Π⁻¹）が危険なのか

Effect（射影）には以下が含まれます：

- 距離  
- 座標  
- スコア  
- 評価値  
- 意味（Semantic）  
- ユーザーの反応  
- 過去の出力  

これらはすべて **因果ではなく結果**です。

Effect を因果入力に使うと：

- 最適化が発生する  
- Goodhart の法則が発動する  
- モデルが「スコアを最大化する方向」に暴走する  
- 意味評価が逆導出を誘発する  
- 構造破断が起きる  

つまり **安全性が崩壊**します。

---

# 🎯 3. 因果ダイオードが許可するもの・禁止するもの

## ✔ 許可される（Cause 側）

| 変数 | 説明 |
|------|------|
| φ（位相） | 時間の進行を表す因果量 |
| ω（角速度） | 系が生きているかの判定 |
| δ（ゆらぎ） | 境界上の振動 |
| τ（厚み） | 境界の許容幅 |
| violation | 制約違反量 |
| workRate | 実仕事の有無 |

これらはすべて **因果的に定義可能**です。

---

## ❌ 禁止される（Effect 側）

| 変数 | 理由 |
|------|------|
| 距離 | 中心が存在しないため定義不能 |
| 座標 | 射影であり因果ではない |
| スコア | 最適化を誘発する |
| 評価値 | 逆導出を誘発する |
| 意味（Semantic） | モデル依存で安全性が揺らぐ |
| 目標位置 | 中心を導入してしまう |
| 過去の出力 | 逆導出の温床 |

Effect を Cause に戻す行為は、  
**構造破断（Fracture）** を引き起こします。

---

# 🎯 4. 因果ダイオードの図示

```
┌──────────────────────────────────────────────┐
│                                              │
│   CAUSE（因果）               EFFECT（射影） │
│                                              │
│   ┌──────────────┐     Π      ┌──────────────┐ │
│   │ Phase (φ)     │ ─────────→│ Distance     │ │
│   │ Fluctuation   │  Allowed  │ Coordinates  │ │
│   │ Thickness     │           │ Score        │ │
│   │ Work          │           │ Meaning      │ │
│   └──────────────┘           └──────────────┘ │
│                        │                       │
│                        │ Π⁻¹（禁止）           │
│                        ▼                       │
│                （逆導出は構造的に遮断）       │
│                                              │
└──────────────────────────────────────────────┘
```

---

# 🎯 5. 因果ダイオードが守るもの

因果ダイオードは、  
NRA‑IDE の以下の性質を守ります：

### ✔ 1. 最適化の禁止  
距離・スコアが存在しないため、  
最適化が発生しない。

### ✔ 2. Goodhart の法則の回避  
スコアを最大化する方向に暴走しない。

### ✔ 3. モデル非依存性  
Effect を使わないため、  
どの LLM にも適用可能。

### ✔ 4. 意味依存の排除  
Semantic を扱わないため、  
安全性が揺らがない。

### ✔ 5. 構造破断の早期検出  
Cause 側の逸脱（violation）だけを監視するため、  
破断を即座に検出できる。

---

# 🎯 6. 実装上の注意

因果ダイオードを実装する際は、  
以下を必ず守る必要があります：

- Effect を因果入力に使わない  
- 意味評価を行わない  
- 距離・座標・スコアを扱わない  
- Pre‑RNA / Post‑RNA のどちらも Effect を参照しない  
- 破断時は必ず Fail‑Closed  
- 熱廃棄ログを記録する  

これらを破ると、  
NRA‑IDE は **構造破断** を起こします。

---

# 🎯 7. 因果ダイオードの本質

因果ダイオードの本質は次の一文に集約されます：

> **「因果として定義できないものを、因果入力として扱わない。」**

距離も、スコアも、意味も、  
すべて **射影（Effect）** であり因果ではありません。

NRA‑IDE は因果構造のみを扱うことで、  
安全性を構造的に保証します。
